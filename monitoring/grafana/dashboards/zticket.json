{
  "id": null,
  "uid": "zticket",
  "title": "ZTicket Monitoring",
  "timezone": "browser",
  "refresh": "5s",
  "time": { "from": "now-5m", "to": "now" },
  "templating": { "list": [] },
  "annotations": { "list": [] },
  "panels": [
    {
      "id": 100,
      "type": "row",
      "title": "HTTP",
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 0 },
      "collapsed": false
    },
    {
      "id": 1,
      "title": "HTTP Request Rate (req/s)",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 1 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [
        {
          "refId": "A",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "rate(http_server_requests_seconds_count{application=\"zticket\"}[1m])",
          "legendFormat": "{{method}} {{uri}} [{{status}}]"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "reqps",
          "custom": { "drawStyle": "line", "lineWidth": 1, "fillOpacity": 10, "showPoints": "never" }
        },
        "overrides": []
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max"] },
        "tooltip": { "mode": "multi" }
      }
    },
    {
      "id": 3,
      "title": "HTTP Error Rate (4xx + 5xx)",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 1 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [
        {
          "refId": "A",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "rate(http_server_requests_seconds_count{application=\"zticket\", status=~\"4..|5..\"}[1m])",
          "legendFormat": "{{method}} {{uri}} [{{status}}]"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "reqps",
          "custom": { "drawStyle": "line", "lineWidth": 1, "fillOpacity": 10, "showPoints": "never" }
        },
        "overrides": []
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max"] },
        "tooltip": { "mode": "multi" }
      }
    },
    {
      "id": 2,
      "title": "HTTP Response Time (p95)",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 9 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [
        {
          "refId": "A",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "histogram_quantile(0.95, sum(rate(http_server_requests_seconds_bucket{application=\"zticket\"}[1m])) by (le, method, uri))",
          "legendFormat": "p95 {{method}} {{uri}}"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s",
          "custom": { "drawStyle": "line", "lineWidth": 1, "fillOpacity": 10, "showPoints": "never" }
        },
        "overrides": []
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max"] },
        "tooltip": { "mode": "multi" }
      }
    },
    {
      "id": 13,
      "title": "HTTP Response Time (p99)",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 9 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [
        {
          "refId": "A",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "histogram_quantile(0.99, sum(rate(http_server_requests_seconds_bucket{application=\"zticket\"}[1m])) by (le, method, uri))",
          "legendFormat": "p99 {{method}} {{uri}}"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s",
          "custom": { "drawStyle": "line", "lineWidth": 1, "fillOpacity": 10, "showPoints": "never" }
        },
        "overrides": []
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max"] },
        "tooltip": { "mode": "multi" }
      }
    },
    {
      "id": 15,
      "title": "HTTP Response Time (p99.9)",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 17 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [
        {
          "refId": "A",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "histogram_quantile(0.999, sum(rate(http_server_requests_seconds_bucket{application=\"zticket\"}[1m])) by (le, method, uri))",
          "legendFormat": "p999 {{method}} {{uri}}"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s",
          "custom": { "drawStyle": "line", "lineWidth": 1, "fillOpacity": 10, "showPoints": "never" }
        },
        "overrides": []
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max"] },
        "tooltip": { "mode": "multi" }
      }
    },
    {
      "id": 20,
      "title": "Logback Error / Warn Events",
      "description": "애플리케이션 에러/경고 발생률",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 17 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [
        {
          "refId": "A",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "rate(logback_events_total{application=\"zticket\", level=\"error\"}[1m])",
          "legendFormat": "error/s"
        },
        {
          "refId": "B",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "rate(logback_events_total{application=\"zticket\", level=\"warn\"}[1m])",
          "legendFormat": "warn/s"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "custom": { "drawStyle": "line", "lineWidth": 1, "fillOpacity": 10, "showPoints": "never" },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "orange", "value": 0.5 },
              { "color": "red", "value": 5 }
            ]
          },
          "color": { "mode": "palette-classic" }
        },
        "overrides": []
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max", "last"] },
        "tooltip": { "mode": "multi" }
      }
    },

    {
      "id": 101,
      "type": "row",
      "title": "App - JVM",
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 25 },
      "collapsed": false
    },
    {
      "id": 9,
      "title": "CPU Usage",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 26 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [
        {
          "refId": "A",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "process_cpu_usage{application=\"zticket\"}",
          "legendFormat": "process"
        },
        {
          "refId": "B",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "system_cpu_usage{application=\"zticket\"}",
          "legendFormat": "system"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "percentunit",
          "min": 0,
          "max": 1,
          "custom": { "drawStyle": "line", "lineWidth": 1, "fillOpacity": 10, "showPoints": "never" }
        },
        "overrides": []
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max"] },
        "tooltip": { "mode": "multi" }
      }
    },
    {
      "id": 7,
      "title": "JVM Heap Memory",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 26 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [
        {
          "refId": "A",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "sum(jvm_memory_used_bytes{application=\"zticket\", area=\"heap\"})",
          "legendFormat": "used"
        },
        {
          "refId": "B",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "sum(jvm_memory_committed_bytes{application=\"zticket\", area=\"heap\"})",
          "legendFormat": "committed"
        },
        {
          "refId": "C",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "jvm_gc_max_data_size_bytes{application=\"zticket\"}",
          "legendFormat": "max (-Xmx)"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "bytes",
          "custom": { "drawStyle": "line", "lineWidth": 1, "fillOpacity": 10, "showPoints": "never" }
        },
        "overrides": []
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max"] },
        "tooltip": { "mode": "multi" }
      }
    },
    {
      "id": 10,
      "title": "JVM Threads",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 34 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [
        {
          "refId": "A",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "jvm_threads_live_threads{application=\"zticket\"}",
          "legendFormat": "live"
        },
        {
          "refId": "B",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "jvm_threads_peak_threads{application=\"zticket\"}",
          "legendFormat": "peak"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "custom": { "drawStyle": "line", "lineWidth": 1, "fillOpacity": 10, "showPoints": "never" }
        },
        "overrides": []
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max"] },
        "tooltip": { "mode": "multi" }
      }
    },

    {
      "id": 102,
      "type": "row",
      "title": "App - GC",
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 42 },
      "collapsed": false
    },
    {
      "id": 8,
      "title": "GC STW Duration",
      "description": "GC 1회당 평균 STW 시간과 최대 STW 시간",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 43 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [
        {
          "refId": "A",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "rate(jvm_gc_pause_seconds_sum{application=\"zticket\"}[1m]) / rate(jvm_gc_pause_seconds_count{application=\"zticket\"}[1m])",
          "legendFormat": "avg {{action}} {{cause}}"
        },
        {
          "refId": "B",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "jvm_gc_pause_seconds_max{application=\"zticket\"}",
          "legendFormat": "max {{action}} {{cause}}"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s",
          "custom": { "drawStyle": "line", "lineWidth": 1, "fillOpacity": 10, "showPoints": "never" }
        },
        "overrides": []
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max"] },
        "tooltip": { "mode": "multi" }
      }
    },
    {
      "id": 21,
      "title": "GC Count Rate",
      "description": "초당 GC 발생 횟수",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 43 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [
        {
          "refId": "A",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "rate(jvm_gc_pause_seconds_count{application=\"zticket\"}[1m])",
          "legendFormat": "{{action}} {{cause}}"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "ops",
          "custom": { "drawStyle": "line", "lineWidth": 1, "fillOpacity": 10, "showPoints": "never" }
        },
        "overrides": []
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max"] },
        "tooltip": { "mode": "multi" }
      }
    },
    {
      "id": 22,
      "title": "Full GC / Humongous Allocation Count",
      "description": "Major GC(Compaction)와 Humongous Allocation 누적 횟수",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 51 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [
        {
          "refId": "A",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "rate(jvm_gc_pause_seconds_count{application=\"zticket\", action=\"end of major GC\"}[1m])",
          "legendFormat": "Full GC ({{cause}})"
        },
        {
          "refId": "B",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "rate(jvm_gc_pause_seconds_count{application=\"zticket\", cause=\"G1 Humongous Allocation\"}[1m])",
          "legendFormat": "Humongous Allocation"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "ops",
          "custom": { "drawStyle": "line", "lineWidth": 1, "fillOpacity": 10, "showPoints": "never" },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "red", "value": 0.1 }
            ]
          },
          "color": { "mode": "palette-classic" }
        },
        "overrides": []
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max", "last"] },
        "tooltip": { "mode": "multi" }
      }
    },
    {
      "id": 23,
      "title": "Heap Usage After GC",
      "description": "GC 후 long-lived 힙 사용률 (1.0에 가까울수록 Old 영역 포화)",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 51 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [
        {
          "refId": "A",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "jvm_memory_usage_after_gc{application=\"zticket\", area=\"heap\", pool=\"long-lived\"}",
          "legendFormat": "heap usage after GC"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "percentunit",
          "min": 0,
          "max": 1,
          "custom": { "drawStyle": "line", "lineWidth": 1, "fillOpacity": 10, "showPoints": "never" },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "orange", "value": 0.7 },
              { "color": "red", "value": 0.9 }
            ]
          },
          "color": { "mode": "fixed", "fixedColor": "yellow" }
        },
        "overrides": []
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max", "last"] },
        "tooltip": { "mode": "multi" }
      }
    },
    {
      "id": 24,
      "title": "GC Overhead",
      "description": "전체 시간 중 GC에 소비되는 비율",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 59 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [
        {
          "refId": "A",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "jvm_gc_overhead{application=\"zticket\"}",
          "legendFormat": "GC overhead"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "percentunit",
          "min": 0,
          "custom": { "drawStyle": "line", "lineWidth": 2, "fillOpacity": 15, "showPoints": "never" },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "orange", "value": 0.1 },
              { "color": "red", "value": 0.25 }
            ]
          },
          "color": { "mode": "fixed", "fixedColor": "orange" }
        },
        "overrides": []
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max", "last"] },
        "tooltip": { "mode": "multi" }
      }
    },
    {
      "id": 25,
      "title": "Memory Promoted / Allocated Rate",
      "description": "Old 영역으로 승격되는 속도와 전체 할당 속도",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 59 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [
        {
          "refId": "A",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "rate(jvm_gc_memory_promoted_bytes_total{application=\"zticket\"}[1m])",
          "legendFormat": "promoted (→ Old)"
        },
        {
          "refId": "B",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "rate(jvm_gc_memory_allocated_bytes_total{application=\"zticket\"}[1m])",
          "legendFormat": "allocated (→ Eden)"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "Bps",
          "custom": { "drawStyle": "line", "lineWidth": 1, "fillOpacity": 10, "showPoints": "never" }
        },
        "overrides": []
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max"] },
        "tooltip": { "mode": "multi" }
      }
    },

    {
      "id": 103,
      "type": "row",
      "title": "App - Database Pool",
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 67 },
      "collapsed": false
    },
    {
      "id": 6,
      "title": "HikariCP Acquire Time",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 68 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [
        {
          "refId": "A",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "hikaricp_connections_acquire_seconds_max{application=\"zticket\"}",
          "legendFormat": "max acquire"
        },
        {
          "refId": "B",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "rate(hikaricp_connections_acquire_seconds_sum{application=\"zticket\"}[1m]) / rate(hikaricp_connections_acquire_seconds_count{application=\"zticket\"}[1m])",
          "legendFormat": "avg acquire"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s",
          "custom": { "drawStyle": "line", "lineWidth": 1, "fillOpacity": 10, "showPoints": "never" }
        },
        "overrides": []
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max"] },
        "tooltip": { "mode": "multi" }
      }
    },
    {
      "id": 18,
      "title": "HikariCP Connection Timeout",
      "description": "동시 VT 수 > 커넥션 풀 크기일 때 timeout 발생",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 68 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [
        {
          "refId": "A",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "rate(hikaricp_connections_timeout_total{application=\"zticket\"}[1m])",
          "legendFormat": "timeout/s"
        },
        {
          "refId": "B",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "hikaricp_connections_timeout_total{application=\"zticket\"}",
          "legendFormat": "total timeouts"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "custom": { "drawStyle": "line", "lineWidth": 1, "fillOpacity": 10, "showPoints": "never" },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null },
              { "color": "red", "value": 1 }
            ]
          },
          "color": { "mode": "palette-classic" }
        },
        "overrides": []
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max", "last"] },
        "tooltip": { "mode": "multi" }
      }
    },

    {
      "id": 104,
      "type": "row",
      "title": "Redis - Client (Lettuce)",
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 76 },
      "collapsed": false
    },
    {
      "id": 11,
      "title": "Redis Command Rate (ops/s)",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 77 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [
        {
          "refId": "A",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "rate(lettuce_seconds_count{application=\"zticket\"}[1m])",
          "legendFormat": "{{db_operation}}"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "ops",
          "custom": { "drawStyle": "line", "lineWidth": 1, "fillOpacity": 10, "showPoints": "never" }
        },
        "overrides": []
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max"] },
        "tooltip": { "mode": "multi" }
      }
    },
    {
      "id": 12,
      "title": "Redis Latency (p95)",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 77 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [
        {
          "refId": "A",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "histogram_quantile(0.95, sum(rate(lettuce_seconds_bucket{application=\"zticket\"}[1m])) by (le, db_operation))",
          "legendFormat": "p95 {{db_operation}}"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s",
          "custom": { "drawStyle": "line", "lineWidth": 1, "fillOpacity": 10, "showPoints": "never" }
        },
        "overrides": []
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max"] },
        "tooltip": { "mode": "multi" }
      }
    },
    {
      "id": 14,
      "title": "Redis Latency (p99)",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 85 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [
        {
          "refId": "A",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "histogram_quantile(0.99, sum(rate(lettuce_seconds_bucket{application=\"zticket\"}[1m])) by (le, db_operation))",
          "legendFormat": "p99 {{db_operation}}"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s",
          "custom": { "drawStyle": "line", "lineWidth": 1, "fillOpacity": 10, "showPoints": "never" }
        },
        "overrides": []
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max"] },
        "tooltip": { "mode": "multi" }
      }
    },
    {
      "id": 16,
      "title": "Redis Latency (p99.9)",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 85 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [
        {
          "refId": "A",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "histogram_quantile(0.999, sum(rate(lettuce_seconds_bucket{application=\"zticket\"}[1m])) by (le, db_operation))",
          "legendFormat": "p999 {{db_operation}}"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s",
          "custom": { "drawStyle": "line", "lineWidth": 1, "fillOpacity": 10, "showPoints": "never" }
        },
        "overrides": []
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max"] },
        "tooltip": { "mode": "multi" }
      }
    },

    {
      "id": 105,
      "type": "row",
      "title": "Redis - Server",
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 93 },
      "collapsed": false
    },
    {
      "id": 30,
      "title": "Redis CPU Usage",
      "description": "Redis 서버 CPU 사용률 (user + system)",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 94 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [
        {
          "refId": "A",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "rate(redis_cpu_user_seconds_total[1m]) + rate(redis_cpu_sys_seconds_total[1m])",
          "legendFormat": "total"
        },
        {
          "refId": "B",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "rate(redis_cpu_user_seconds_total[1m])",
          "legendFormat": "user"
        },
        {
          "refId": "C",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "rate(redis_cpu_sys_seconds_total[1m])",
          "legendFormat": "system"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "percentunit",
          "custom": { "drawStyle": "line", "lineWidth": 1, "fillOpacity": 10, "showPoints": "never" }
        },
        "overrides": [
          {
            "matcher": { "id": "byName", "options": "total" },
            "properties": [{ "id": "custom.lineWidth", "value": 2 }]
          }
        ]
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max", "last"] },
        "tooltip": { "mode": "multi" }
      }
    },
    {
      "id": 31,
      "title": "Redis Memory",
      "description": "Redis 메모리 사용량 vs maxmemory",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 94 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [
        {
          "refId": "A",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "redis_memory_used_bytes",
          "legendFormat": "used"
        },
        {
          "refId": "B",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "redis_memory_max_bytes",
          "legendFormat": "max (700MB)"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "bytes",
          "custom": { "drawStyle": "line", "lineWidth": 1, "fillOpacity": 10, "showPoints": "never" }
        },
        "overrides": []
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max", "last"] },
        "tooltip": { "mode": "multi" }
      }
    },
    {
      "id": 32,
      "title": "Redis Connected Clients",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 102 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [
        {
          "refId": "A",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "redis_connected_clients",
          "legendFormat": "connected clients"
        },
        {
          "refId": "B",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "redis_blocked_clients",
          "legendFormat": "blocked clients"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "custom": { "drawStyle": "line", "lineWidth": 1, "fillOpacity": 10, "showPoints": "never" }
        },
        "overrides": []
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max", "last"] },
        "tooltip": { "mode": "multi" }
      }
    },
    {
      "id": 33,
      "title": "Redis Commands/s & Hit Rate",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 102 },
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [
        {
          "refId": "A",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "rate(redis_commands_processed_total[1m])",
          "legendFormat": "commands/s"
        },
        {
          "refId": "B",
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "expr": "rate(redis_keyspace_hits_total[1m]) / (rate(redis_keyspace_hits_total[1m]) + rate(redis_keyspace_misses_total[1m]))",
          "legendFormat": "hit rate"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "custom": { "drawStyle": "line", "lineWidth": 1, "fillOpacity": 10, "showPoints": "never" }
        },
        "overrides": [
          {
            "matcher": { "id": "byName", "options": "commands/s" },
            "properties": [{ "id": "unit", "value": "ops" }]
          },
          {
            "matcher": { "id": "byName", "options": "hit rate" },
            "properties": [{ "id": "unit", "value": "percentunit" }, { "id": "min", "value": 0 }, { "id": "max", "value": 1 }]
          }
        ]
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "bottom", "calcs": ["mean", "max", "last"] },
        "tooltip": { "mode": "multi" }
      }
    }
  ]
}
